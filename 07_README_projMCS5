## 07. Project MCS5

# projMCS5.R
- Adds peak matrix
- Identifies marker peaks by cluster
  - cutOff = "FDR <= 0.01 & Log2FC >= 1.25"
- Plots marker peaks
  - cutOff = "FDR<=0.01 & Log2FC>=1.25"
- Adds motif annotations
  - motifSet = "cisbp"
## NOTE: The 07_projMCS5.R code did not use abs(Log2FC)
## The 07_projMCS5-w-ABS-Log2FC.R code accommodates for that and reruns getMarkerFeatures before applying cutoffs

# 07_projMCS5-w-ABS-Log2FC.R
- Identifies marker peaks by cluster
  - cutOff = "FDR <= 0.01 & abs(Log2FC) >= 1.25"
  - 07_Peak_markerList_2025-03-06.csv
- Plots marker peaks
  - cutOff = "FDR<=0.01 & abs(Log2FC)>=1.25"
  - 07_Peak-Marker-Heatmap_2025-03-06.pdf


######################################


## Cell Abundance

# 07_projMCS5_cellAbundance.R
- Cell abundance analysis uses 07_Cell-Abundance_2024-02-08.csv
- Performs ANOVA to determine significant differences between treatment groups

# 07_Abundance_Boxplots_2024-04-11.R
- Cell abundance analysis uses 07_Cell-Abund_Boxplot_2024-04-11.csv
- Improved stats from 07_projMCS5_cellAbundance.R
- Uses ANOVA, t-tests, and Bonforonni correction
- C8 & C20 show significant differences

# 07_Cell_Abundance_Boxplots_2024-12-09.R
- Cell abundance analysis uses 07_Cell-Abund_Boxplot_2024-04-11.csv
- Improved color palette than those run on 2024-04-11
- C8 shows significant differences by treatment

# 07_CellAbundance_Boxplots_wStats_2025-02-21
- Cell abundance analysis uses 07_Cell-Abund_Boxplot_2024-04-11.csv
- Improved color palette and stats than those run on 2024-04-11 & 2024-12-09
- Uses ANOVA, then for those that are sig, uses t-tests, followed by Bonforonni correction
- See below for sig differences by comparison

# Files created by Cell_Abundance_Boxplots_2024-12-09.R (do not display stats):
- 07_CellAbund_Boxplots_2024-12-09.jpg
- 07_CellAbund_Boxplots_wMean_2024-12-09.jpg
- 07_CellAbund_Boxplots_ByCellType_2024-12-09.jpg
- 07_CellAbund_Boxplots_by_Genotype-CellType_2024-12-09.jpg
- 07_CellAbund_Boxplot_TsCombined_2024-12-09.pdf
- 07_CellAbund_Boxplot_2NCombined_2024-12-09.pdf

# Files created by Cell_Abundance_Boxplots_wStats_2025-02-21.R (incl. sig stats):
- 07_CellAbund_Boxplots_Stats_wMean_byCluster_2025-02-21.jpg
- 07_CellAbund_Boxplots_Stats_byCluster_2025-02-21.jpg
- 07_CellAbund_Genotype_Stats_2025-02-21.csv
- 07_CellAbund_Boxplots_by_Genotype-CellType_Stats_2025-02-21.pdf
- 07_CellAbund_Boxplots_by_Genotype-CellType_Stats_2025-02-21.jpg
  * P-adj pairwise comparisons show sig diff in Astrocytes comparing 2N & 2N+ vs. Ts & Ts+
- 07_CellAbund_Pairwise_Stats_byCluster_2025-02-21.csv
  * P-adj pairwise comparisons show sig diff in cluster specific comparisons:
    - C8 2N+ vs Ts, C8 2N+ vs Ts+, C14 2N+ vs Ts+, C20 2N vs Ts
- 07_CellAbund_Boxplots_2N_vs_2N+_cellType_2025-02-21.pdf
- 07_CellAbund_Boxplots_2N_vs_2N+_cellType_2025-02-21_ANOVA_cellType_stats_2025-02-21.csv
- 07_CellAbund_Boxplots_2N_vs_2N+_cellType_2025-02-21_pairwise_cellType_stats_2025-02-21.csv
  * No sig differences found in 2N vs 2N+ by cell type
- 07_CellAbund_Boxplots_2N_vs_Ts_cellType_2025-02-21.pdf
- 07_CellAbund_Boxplots_2N_vs_Ts_cellType_2025-02-21_pairwise_cellType_stats_2025-02-21.csv
- 07_CellAbund_Boxplots_2N_vs_Ts_cellType_2025-02-21_ANOVA_cellType_stats_2025-02-21.csv
  * P-adj pairwise comparisons show sig diff in Astrocytes comparing 2N vs Ts
- 07_CellAbund_Boxplots_2N_vs_Ts+_cellType_2025-02-21.pdf
- 07_CellAbund_Boxplots_2N_vs_Ts+_cellType_2025-02-21_pairwise_cellType_stats_2025-02-21.csv
- 07_CellAbund_Boxplots_2N_vs_Ts+_cellType_2025-02-21_ANOVA_cellType_stats_2025-02-21.csv
  * P-adj pairwise comparisons show sig diff in Astrocytes comparing 2N vs Ts+
- 07_CellAbund_Boxplots_2N+_vs_Ts_cellType_2025-02-21.pdf
- 07_CellAbund_Boxplots_2N+_vs_Ts_cellType_2025-02-21_pairwise_cellType_stats_2025-02-21.csv
- 07_CellAbund_Boxplots_2N+_vs_Ts_cellType_2025-02-21_ANOVA_cellType_stats_2025-02-21.csv
  * P-adj pairwise comparisons show sig diff in Astrocytes comparing 2N+ vs Ts
- 07_CellAbund_Boxplots_2N+_vs_Ts+_cellType_2025-02-21.pdf
- 07_CellAbund_Boxplots_2N+_vs_Ts+_cellType_2025-02-21_pairwise_cellType_stats_2025-02-21.csv
- 07_CellAbund_Boxplots_2N+_vs_Ts+_cellType_2025-02-21_ANOVA_cellType_stats_2025-02-21.csv
  * P-adj pairwise comparisons show sig diff in Astrocytes & GlutOligo comparing 2N+ vs Ts
- 07_CellAbund_Boxplots_Ts_vs_Ts+_cellType_2025-02-21.pdf
- 07_CellAbund_Boxplots_Ts_vs_Ts+_cellType_2025-02-21_pairwise_cellType_stats_2025-02-21.csv
- 07_CellAbund_Boxplots_Ts_vs_Ts+_cellType_2025-02-21_ANOVA_cellType_stats_2025-02-21.csv
  * No sig differences found in 2N vs 2N+ by cell type


######################################



## Cluster identification using specific gene markers


# 07_projMCS5_ArchRBrowser.R
- Additional browser track gene regions of interest
- Subset by treatment group
- C18 Subcluster subset by treatment group
- Files generated using this code:
  - 07_Browser-Tracks_C18-grpByTx_2024-06-05.pdf
  - 07_Browser-Tracks_T3-grpByClusters_2024-06-05.pdf


07_projMCS5_ClusterID_UMAP.R
- Additional UMAPs created using genes of interest
- File generated: 07_UMAP-Marker-Genes-W-Imputation_2024-04-04.pdf


07_projMCS5_markerList_byCluster-Tx.R
- Creates heatmap & z-scores for 4 treatment groups using all sig genes found in C18, subset by C18
- Generates file: 07_C18_All127_byTx_zscores_2024-03-13.csv


07_projMCS5_GeneMarkers_TxComp-byCluster_Heatmap.R
- Subsets by cluster
- Uses marker genes known to be significant for the cluster of interest
- Creates z-scores and heatmaps by treatment
- File names ex: C4_byTx_zscores_2024-03-21.csv & C4_TxComp_Heatmap_2024-03-21.pdf
07_projMCS5_C1_Sorted_Heatmap.R
- First sorted heatmaps created
07_projMCS7_GeneMarkers_byCluster-TxGrp_2024-10-17.R
- Upgrades from previous 2 code records include sorted heatmaps in 1 file
07_projMCS5_GeneMarkers_byClusterTxComp_Loop_2024-10-17.R
- Subsets by cluster, group by treatment; loop for all clusters
07_projMCS7_GeneMarkers_byCellType-TxGrp_2025-01-16.R
- Similar code to projMCS7_GeneMarkers_byCluster-TxGrp_2025-01-16.R but focuses on cell type groups
* - Files saved ex: astro_GeneMarker_List_2025-01-16.csv


07_projMCS5_geneMarkers_byClusterTxGrp_2024-04-10.R
- Subsets by treatment, group by cluster
- cutOff = "FDR <= 0.01 & abs(Log2FC) >= 1.25"
07_projMCS5_geneMarkers_byClusterTxGrp_2024-04-26.R
- code updated from the above
- cutOff = "FDR <= 0.01 & abs(Log2FC) >= 1.25"
- Subsets by treatment, group by cluster
- File names ex: T1_C1_GeneMarkers_2024-04-10.csv
- Subsets by cluster, group by treatment
- File names ex: C1_GeneMarker_List_2024-04-08.csv & GeneMarker_List_Master_2024-04-08.csv

07_projMCS5_Pairwise_byClusterTxGrp_2024-05-21.R

07_projMCS5_GeneMarkers_TxComp-byCluster_2024-04-29.R

07_projMCS5_Zu-2023_geneMarker_UMAPs.R




## 07_MCS2023_2024-14.pptx provides a summary of this analysis
